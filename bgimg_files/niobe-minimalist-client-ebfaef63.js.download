(window.webpackJsonp=window.webpackJsonp||[]).push([["1591"],{"+oWa":function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return o}));class n{constructor(e){this.key=void 0,this.size=void 0,this.result=void 0,this.watchers=void 0,this.key=e,this.watchers=[],this.size=0}setResult(e){const t=this.result;this.result=e;const r=JSON.stringify(null==e?void 0:e.data),n=r===JSON.stringify(null==t?void 0:t.data);this.size=null!=e&&e.data?r.length:0,n||this.notify()}isCollectable(){return 0===this.watchers.length}watch(e){const t=this;return t.watchers=t.watchers.concat(e),function(){t.watchers=t.watchers.filter(t=>t!==e)}}notify(){const{watchers:e,result:t}=this;this.watchers=[],Promise.resolve().then(()=>e.forEach(e=>e(t)))}}class i{constructor({hydrationData:e,metricReporter:t,maxSize:r=1/0}){this.data=void 0,this.size=void 0,this.maxSize=void 0,this.lastTouchedEntry=void 0,this.metricReporter=void 0,this.data=new Map,this.size=0,this.maxSize=r,this.metricReporter=t,e.forEach(([e,t])=>{this.set(e,t)})}serialize(){return Array.from(this.data.entries()).reduce((e,[t,r])=>{if(null!==r&&void 0!==r.result){const{data:n,error:i,deferred:s}=r.result;e.push([t,{data:n,error:i,deferred:s}])}return e},[])}get(e){const{data:t,metricReporter:r}=this,n=t.get(e);if(null===n&&r.increment("frontend.niobe.mini_cache_miss",1,{}),n)return this.touch(n),n.result}set(e,t){var r;const{data:i}=this,s=i.get(e),o=null!=s?s:new n(e);o.setResult(t),this.touch(o),this.size+=o.size-(null!==(r=null==s?void 0:s.size)&&void 0!==r?r:0),this.prune()}watch(e,t){var r;const{data:i}=this,s=null!==(r=i.get(e))&&void 0!==r?r:new n(e);return i.set(e,s),s.watch(t)}invalidate({keyPrefix:e}){const{data:t}=this;[...t.keys()].filter(t=>t.startsWith(e)).forEach(e=>{this.set(e,void 0)})}delete(e){const t=this.data.get(e);t&&(this.data.set(e,null),this.size-=t.size)}touch(e){e!==this.lastTouchedEntry&&(this.lastTouchedEntry=e,this.data.delete(e.key),this.data.set(e.key,e))}prune(){for(const[e,t]of this.data){if(this.size<=this.maxSize)break;null!==t&&t.isCollectable()&&this.delete(e)}}}function s(e,{key:t,fetchPolicy:r,deferrable:n,queryRef:i},s){if(i){if(i.options.deferrable&&"server-render"===s())return;const{result:e}=i;return e||void 0}if("network-only"===r||"no-cache"===r)return;if("cache-and-network"===r&&"client-hydration"!==s())return;if("server-render"===s()&&n)return void e.set(t,{data:void 0,deferred:!0});const o=e.get(t);return"server-render"===s()&&null!=o&&o.deferred?void 0:o}function o(e,{key:t,fetchPolicy:r},n){var i;n.deferred||"no-cache"!==r&&(!n.error||null!==(i=e.get(t))&&void 0!==i&&i.deferred)&&e.set(t,n)}},"4Pjp":function(e,t){},"7nFp":function(e,t,r){"use strict";function n(e,t){if(e.skip)return t}r.d(t,"a",(function(){return n}))},EG3x:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("D4yp");function i(e){var t;const r=Object(n.a)();return Object.assign({},e,{context:Object.assign({},null==e?void 0:e.context,{eventId:r,queryString:Object.assign({},null==e||null===(t=e.context)||void 0===t?void 0:t.queryString,{_cb:r})})})}},FRDn:function(e,t,r){"use strict";r.d(t,"NetworkStatus",(function(){return n}));r("4Pjp");let n;!function(e){e[e.loading=1]="loading",e[e.setVariables=2]="setVariables",e[e.fetchMore=3]="fetchMore",e[e.refetch=4]="refetch",e[e.poll=6]="poll",e[e.ready=7]="ready",e[e.error=8]="error"}(n||(n={}))},GamM:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return o}));var n=r("rve7"),i=r("EDtc");function s({operation:e}){return Object(i.f)(e)+":"}function o(e){var t,r;const{operation:s,variables:o,skip:a}=null!==(t=e.queryRef)&&void 0!==t&&t.options?null===(r=e.queryRef)||void 0===r?void 0:r.options:e,c=Object(i.f)(s),u=Object(i.g)(s)?"query":"mutation",l=Object(n.a)({operationName:c,variables:o,skip:a});return Object.assign({},e,{operationName:c,operationType:u,key:l})}},Gf7j:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("q1tI");function i(){const[,e]=Object(n.useState)({}),t=function(){const e=Object(n.useRef)(!0);return Object(n.useEffect)(()=>()=>{e.current=!1},[]),e}(),r=Object(n.useRef)(!1);return r.current=!1,{rerender:()=>{t.current&&(r.current=!0,e({}))},isRerenderScheduled:r}}},"Gmx/":function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return a}));var n=r("ilXw"),i=r.n(n),s=r("EDtc");function o(e){var t,r,n;const o=null!==(t=e.query)&&void 0!==t?t:e.mutation,a=o&&Object(s.e)(o);if(null!==(r=e.context)&&void 0!==r&&r.skipOperationRegistry||!o||!a||i.a.get("useViaductNext"))return Object.assign({},e,{context:Object.assign({},e.context,{operationId:void 0})});const c=e,u=Object.assign({},null==c?void 0:c.extensions,{persistedQuery:{version:1,sha256Hash:a}}),l=Object(s.g)(o)&&!c.usePOSTForQuery?"GET":"POST";var d,h;return"GET"===l?Object.assign({},c,{context:Object.assign({},null==c?void 0:c.context,{operationId:a,queryString:Object.assign({},null==c||null===(d=c.context)||void 0===d?void 0:d.queryString,{variables:JSON.stringify(null==c?void 0:c.variables),extensions:JSON.stringify(u)}),fetchOptions:Object.assign({},null==c||null===(h=c.context)||void 0===h?void 0:h.fetchOptions,{method:l,body:void 0})})}):Object.assign({},c,{context:Object.assign({},null==c?void 0:c.context,{operationId:a,fetchOptions:Object.assign({},null==c||null===(n=c.context)||void 0===n?void 0:n.fetchOptions,{method:l,body:JSON.stringify({operationName:c.operationName,variables:c.variables,extensions:u})})})})}function a(e,t,r){var n,i;if(null!==(n=r.error)&&void 0!==n&&n.graphQLErrors&&null!==(i=r.error)&&void 0!==i&&i.graphQLErrors.some(({message:e})=>"PersistedQueryNotFound"===e)){var o;const r=null!==(o=t.query)&&void 0!==o?o:t.mutation,n=r&&Object(s.c)(r);if(!r)return;const i=Object(s.d)(r),a={method:Object(s.g)(r)&&!t.usePOSTForQuery?"GET":"POST",operation_type:Object(s.g)(r)?"query":"mutation",operation_name:t.operationName,client_type:"niobe_minimalist"};return e.increment("frontend.niobe.operation_registry.error",1,Object.assign({},a,{error_type:"GraphQLError",error_name:"PersistedQueryNotFound"})),n?{skipOperationRegistry:!0}:i.then(()=>({skipOperationRegistry:!0}))}}},JBzR:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return g}));var n=r("ilXw"),i=r.n(n),s=r("Qyje"),o=r.n(s),a=r("I9Za"),c=r.n(a),u=r("qJkm"),l=r("O5Nq"),d=r("lOXG"),h=r("jF57"),f=r("6S1W");let v;function g(t,r,n,s){var a,g,p,b,y;v=null!==(a=v)&&void 0!==a?a:Object(l.a)();const{context:O}=t,m=Object(f.a)("client"),j=`${null!==(w=e)&&void 0!==w&&null!==(R=w.env)&&void 0!==R&&R.NIOBE_ENDPOINT?e.env.NIOBE_ENDPOINT:"/api/v3"}/${t.operationName}`;var w,R;const k=Object.assign({operationName:t.operationName},Object.assign({locale:c.a.locale()},u.a.current().curr?{currency:u.a.current().curr}:{}),null==O?void 0:O.queryString),x=i.a.get("useViaductNext")?"https://viaduct-next.d.musta.ch/v3":`${j}?${o.a.stringify(k)}`,S=function(e,t,r){const n=Object(d.a)(e,t);if(n)return n.then(n=>{if(n)return r.increment("frontend.niobe.recaptcha_v3.append_header",1,{client:"minimalist",endpoint:e,method:t}),n}).catch(e=>{r.increment("frontend.niobe.recaptcha_v3.error",1,{client:"minimalist",status:String(e.statusCode),message:String(e.message)})})}(j,null!==(g=null==t||null===(p=t.context)||void 0===p||null===(b=p.fetchOptions)||void 0===b?void 0:b.method)&&void 0!==g?g:"POST",s);return Object.assign({},t,{fetchUrl:x,context:Object.assign({},O,{queryString:k,asyncHeaders:S,fetchOptions:Object.assign({},null==O?void 0:O.fetchOptions,{headers:Object.assign({},r,null==O?void 0:O.headers,null==O||null===(y=O.fetchOptions)||void 0===y?void 0:y.headers,t.headers,{"X-Airbnb-API-Key":h.a},{"X-CSRF-Token":v},m[n],{"X-CSRF-Without-Token":"1","X-Airbnb-GraphQL-Platform-Client":"minimalist-niobe"})})})})}}).call(this,r("8oxB"))},Shen:function(e,t,r){"use strict";function n(e,t){var r;if(null!==(r=t.context)&&void 0!==r&&r.skipDedupe)return;const n=e.get(t.key);return n||void 0}function i(e,t,r){e.set(t.key,r)}function s(e,t){e.delete(t.key)}r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return s}))},TfS3:function(e,t,r){"use strict";r.d(t,"a",(function(){return u}));var n=r("ilXw"),i=r.n(n),s=r("gCJq"),o=r("hlFt"),a=r("EDtc");const c=(e,t,r)=>({data:null,error:{name:e,message:e,networkError:new Error(r?`${e}. Received body: ${r}`:e),graphQLErrors:[],extraInfo:null},response:t,body:r});async function u(e,t,r){var n;const{operation:u,context:l,fetchUrl:d,operationName:h,variables:f}=r,{asyncHeaders:v,fetchOptions:g}=l,p=null!==(n=null==g?void 0:g.method)&&void 0!==n?n:"POST",b=Object.assign({"Content-Type":"application/json"},v?await v:{},!i.a.get("useViaductNext")&&{"X-Airbnb-GraphQL-Platform":"web"},null==g?void 0:g.headers),y=g&&"body"in g?g.body:JSON.stringify({operationName:h,query:Object(s.print)(Object(a.c)(u)||await Object(a.d)(u)),variables:f}),O=e.now(),m=t(d,Object.assign({},g,{body:y,credentials:i.a.get("useViaductNext")?"omit":"include",headers:b,method:p}));try{const t=await m,r=e.now(),{headers:n}=t,i=n.has("content-length")?Number(n.get("content-length")):null,{ok:s,status:o,statusText:a}=t,u=await t.text(),l=e.now();try{const t=e.now(),n=JSON.parse(u),c=e.now(),{errors:d=[]}=n,h=function(e,t){if(e>=300){const r=new Error("Received unexpected status code "+e);r.statusCode=e,r.body=t;try{r.result=t&&JSON.parse(t)}catch(e){}return r}return null}(o,u),f={contentLength:i,networkStart:O,networkHeadersEnd:r,networkBodyEnd:l,payloadParseStart:t,payloadParseEnd:c};return Object.assign({},n,{response:{ok:s,status:o,statusText:a},metrics:f},h||d.length?{error:{name:"GraphQL errors",message:d.map(e=>e.message).join(" "),graphQLErrors:d,networkError:h,extraInfo:null}}:{})}catch(e){return c("Network error (parse): "+e.message,{ok:s,status:o,statusText:a},u)}}catch(e){return Object(o.c)(e)?{data:null,error:{extraInfo:{aborted:!0},graphQLErrors:[],message:e.message,name:e.message,networkError:null}}:c("Network error (connection): "+e.message)}}},ZFwt:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));function n(e,t,r,{context:{networkErrorAttemptsCount:n=1,fetchOptions:i={}}={}},s){const o=s.response&&(502===s.response.status||503===s.response.status)||!s.response;if(t&&o&&n<2){var a;e.increment("frontend.niobe.network_retry",1,{status:String(null===(a=s.response)||void 0===a?void 0:a.status),client_type:"niobe_minimalist"});const t=2*r**(1+2*n/10)*Math.random(),o=t<6e3?t:6e3;return new Promise(e=>setTimeout(e,o)).then(()=>({networkErrorAttemptsCount:n+1,fetchOptions:Object.assign({},i,{headers:Object.assign({},null==i?void 0:i.headers,{"x-retry":"true"})})}))}}},ey24:function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r("Bz5j"),i=r("wduC"),s=r("SSfp"),o=r("UGwa"),a=r("Bwtj"),c=r("LvwK"),u=r("jiVd");function l(e,t){var r;if(!Object(u.a)())return;const l=Object(o.a)(e,{method:"airlockRetrier"}),d=Object(s.c)(t);d&&Object(s.d)(d);const h=Object(s.a)(null===(r=t.error)||void 0===r?void 0:r.graphQLErrors)||Object(n.b)(t);return h?Object(i.c)(h)?void Object(s.d)(Object(i.a)(h)):(l(),new Promise(r=>{Object(a.a)({airlock:h,onSuccess:()=>{const t={fetchOptions:{headers:Object(c.a)(h,e)}};!Object(n.d)(h)||h.shouldReplayRequest?r(t):r(void 0)},onError:()=>r(void 0),error:t})})):void 0}},jMCr:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("jdOh");class i{constructor({queryRef:e,client:t,stitcher:r}){this.queryRef=void 0,this.stitcher=void 0,this.client=void 0,this.memo=void 0,this.queryRef=e,this.stitcher=r,this.client=t,this.memo=new WeakMap}watchOnce(e){return this.client.watchOnce(this.queryRef,t=>{this.queryRef!==t?e(new i(Object.assign({},this,{queryRef:t}))):this.watchOnce(e)})}isLoading(){const e=this.client.readResult({queryRef:this.queryRef});return!e||!!e.deferred}isNetworkErrored(){var e,t;return Boolean(null===(e=this.getResult())||void 0===e||null===(t=e.error)||void 0===t?void 0:t.networkError)}getResult(){var e,t;const r=this.client.readResult({queryRef:this.queryRef});if(null==r||null===(e=r.error)||void 0===e||null===(t=e.extraInfo)||void 0===t||!t.aborted)return null!=r?r:void 0}stitch(e){var t,r,n;const i=this.memo.get(e);if(i)return i;const s=this.getResult();if(!s)return e;if(!this.stitcher)return e;if(!e.data)return e;const{variables:o}=this.client.getOptions(this.queryRef),a=Object.assign({variables:o},e,{error:null!==(t=s.error)&&void 0!==t?t:e.error,data:this.stitcher(e.data,{fetchMoreResult:null!==(r=null===(n=this.getResult())||void 0===n?void 0:n.data)&&void 0!==r?r:void 0,variables:o})});return this.memo.set(e,a),a}refetch(e){return new i(Object.assign({},this,{queryRef:this.client.executeFrom({queryRef:this.queryRef,options:{variables:e,fetchPolicy:"network-only"}})}))}}const s={data:void 0};class o{static fromQueryRef(e,t){return new o({parent:void 0,client:t,type:"fetch",firstPage:new i({queryRef:e,client:t}),nextPages:[]})}constructor({parent:e,firstPage:t,nextPages:r,client:n,type:i}){this.parent=void 0,this.firstPage=void 0,this.nextPages=void 0,this.type=void 0,this.client=void 0,this.memo=void 0,this.parent=e,this.firstPage=t,this.nextPages=r,this.client=n,this.type=i,this.memo=new WeakMap}pages(){return[this.firstPage].concat(this.nextPages)}watchOnce(e){const t=this.pages().map((r,n)=>r.watchOnce(r=>{t.forEach(e=>e()),e(this,new o({parent:this,firstPage:0===n?r:this.firstPage,nextPages:n>=1?this.nextPages.slice(0,n-1).concat(r).concat(this.nextPages.slice(n)):this.nextPages,client:this.client,type:this.type}))}))}isLoading(){return this.firstPage.isLoading()}async onLoaded(e){return await Promise.all(this.pages().map(e=>e.queryRef.promise)),(()=>e(this))()}getNetworkStatus(){if(this.pages().some(e=>e.isNetworkErrored()))return n.NetworkStatus.error;if(!this.pages().some(e=>e.isLoading()))return n.NetworkStatus.ready;switch(this.type){case"fetch":return n.NetworkStatus.loading;case"refetch":return n.NetworkStatus.refetch;case"fetchMore":return n.NetworkStatus.fetchMore;case"setVariables":return n.NetworkStatus.setVariables;default:return n.NetworkStatus.ready}}getResult(){var e,t;const{firstPage:r,nextPages:n}=this,i=r.getResult(),o=null===(e=this.loadedAncestor())||void 0===e?void 0:e.getResult(),a=i&&n.reduce((e,t)=>t.stitch(e),i),c=null!==(t=null!=a?a:o)&&void 0!==t?t:s;return this.augmentResultFor(c)}getMemoizedResult(e){var t,r;return null!==(t=this.memo.get(e))&&void 0!==t?t:null===(r=this.parent)||void 0===r?void 0:r.getMemoizedResult(e)}augmentResultFor(e){var t;const{client:r,firstPage:n}=this,i=this.getMemoizedResult(e);if(i&&i.networkStatus===this.getNetworkStatus())return i;const s=Object.assign({},e,{data:null!==(t=e.data)&&void 0!==t?t:void 0,loading:this.isLoading(),stale:!1,variables:r.getOptions(n.queryRef).variables,queryRef:n.queryRef,networkStatus:this.getNetworkStatus()});return this.memo.set(e,s),s}loadedAncestor(){if(this.parent)return this.parent.isLoading()?this.parent.loadedAncestor():this.parent}replaceWith(e){return new o(Object.assign({},this,{parent:this,firstPage:new i({queryRef:e,client:this.client}),nextPages:[],type:"setVariables"}))}refetch(e){return new o(Object.assign({},this,{parent:this,firstPage:this.firstPage.refetch(e),nextPages:[],type:"refetch"}))}addPage(e,t){const r=new i({queryRef:this.client.executeFrom({queryRef:this.firstPage.queryRef,options:{variables:e}}),stitcher:t,client:this.client});return{newQueryAggregate:new o(Object.assign({},this,{parent:this,firstPage:this.firstPage,nextPages:[...this.nextPages,r],type:"fetchMore"})),newQueryPage:r}}}},jdOh:function(e,t,r){"use strict";var n=r("FRDn");r.o(n,"NetworkStatus")&&r.d(t,"NetworkStatus",(function(){return n.NetworkStatus}))},lOXG:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return u}));var n=r("mVwX"),i=r("ifln"),s=r("7Aoz"),o=r("Yg/F");const a=e=>{const{extensions:{errorClass:t="",errorType:r="",response:{statusCode:n=0}={}}={}}=e;return"ValidationRequiredException"===t||"validation_required"===r||440===n};function c(e,t){var r,i;const s=null===(r=t.error)||void 0===r||null===(i=r.graphQLErrors)||void 0===i?void 0:i.find(a);if(!s)return;const c=(e=>{if(void 0===e)return"unknown";const t=e[0];return"number"==typeof t?String(t):t})(s.path);return Object(n.getRecaptchaV3TokenHeader)({action:c,timeoutInMs:5e3,maxRetries:5,shouldThrow:!0}).then(t=>{var r;const n=null===(r=e.context)||void 0===r?void 0:r.fetchOptions;return{fetchOptions:Object.assign({},n,{headers:Object.assign({},null==n?void 0:n.headers,t)})}}).catch(()=>{Object(o.a)()})}function u(e,t){if(!Object(s.a)())return null;const r=Object(i.maybeGetRecaptchaV3TokenHeader)(e,t,!0);return r?r():null}},niQI:function(e,t,r){"use strict";r.r(t),r.d(t,"NiobeMinimalistClient",(function(){return k}));var n=r("q1tI"),i=(r("QZac"),r("uyjd")),s=r("QqwG"),o=r("8SGJ"),a=r("SchF"),c=r("7nFp"),u=r("GamM"),l=r("+oWa"),d=r("hUEr"),h=r("Shen"),f=r("Gmx/"),v=r("ey24"),g=r("ZFwt"),p=r("JBzR"),b=r("EG3x"),y=r("lOXG"),O=r("TfS3"),m=r("Gf7j"),j=r("jMCr"),w=r("oema");for(var R in w)["NiobeMinimalistClient","default"].indexOf(R)<0&&function(e){r.d(t,e,(function(){return w[e]}))}(R);class k{constructor({data:e=[],fetch:t,metricReporter:r,jitneyLogger:n,cacheMaxSize:i=8388608,cache:s=new l.a({hydrationData:e,maxSize:i,metricReporter:r}),inflight:o=new Map,retryOnNetworkError:a=!0,retryDelay:c=300,extraHeaders:u={},disablePrepare:d=!1,getRenderingState:h,graphQLGateway:f="niobe"}){this.type="minimalist",this.cache=void 0,this.inflight=void 0,this.metricReporter=void 0,this.jitneyLogger=void 0,this.fetch=void 0,this.getRenderingState=void 0,this.retryOnNetworkError=void 0,this.retryDelay=void 0,this.extraHeaders=void 0,this.disablePrepare=void 0,this.skipResult=void 0,this.graphQLGateway=void 0,this.cache=s,this.inflight=o,this.retryOnNetworkError=a,this.retryDelay=c,this.getRenderingState=h,this.metricReporter=r,this.jitneyLogger=n,this.extraHeaders=u,this.disablePrepare=d,this.fetch=t,this.skipResult={data:void 0,skip:!0},this.metricReporter.increment("niobe_client_type",1,{clientType:"minimalist"}),this.graphQLGateway=f}preloadQuery(e){return this.execute(Object(s.b)(e))}async query(e){var t;const r=await this.execute(Object(s.b)(e)).promise;if(null!==(t=r.error)&&void 0!==t&&t.networkError)throw r.error.networkError;return r}readQuery(e){var t,r,n,i;return e.queryRef&&!e.queryRef.options.deferrable?null!==(t=null===(r=e.queryRef.result)||void 0===r?void 0:r.data)&&void 0!==t?t:null:null!==(n=null===(i=this.readResult(Object(s.b)(e)))||void 0===i?void 0:i.data)&&void 0!==n?n:null}writeQuery(e){const t=this.transformOptions(Object(s.b)(e)),r={data:e.data},n=o.a.for({options:Object(s.b)(e),promise:Promise.resolve(r),result:r,clientType:this}),{promise:i}=n;this.processResult({transformedOptions:t,result:r,promise:i,source:"manual"})}async mutate(e){const t=await this.execute(Object(s.a)(e)).promise;if(t.error){var r,n,i;if(t.error.networkError)throw null===(r=t.error)||void 0===r?void 0:r.networkError;if((null===(n=t.error)||void 0===n||null===(i=n.graphQLErrors)||void 0===i?void 0:i.length)>0){var o,a;const e=new Error(null===(o=t.error)||void 0===o||null===(a=o.graphQLErrors)||void 0===a?void 0:a.map(e=>e.message).join("\n"));throw e.graphQLErrors=t.error.graphQLErrors,e}}return t}extract(){return this.cache.serialize()}updateCache(e){e.forEach(([e,t])=>{Object(l.c)(this.cache,{key:e},t)})}readResult(e){const{queryRef:{clientType:t}={}}=e;if(t&&t!==this&&Object(a.m)(Object(a.j)(this,t)),e.queryRef){var r,n;if(e.queryRef.deferred)return;return null!==(r=null===(n=e.queryRef)||void 0===n?void 0:n.result)&&void 0!==r?r:void 0}const i=this.transformOptions(e),[,s]=this.syncResolve(i)||[];return s}getOptions(e){return e.options}watchOnce(e,t){const r=this.getOptions(e);return this.cache.watch(this.transformOptions(r).key,e=>{const n=e?o.a.for({promise:Promise.resolve(e),result:e,clientType:this,options:r,deferred:e.deferred}):this.execute(r);t(n)})}executeFrom({queryRef:e,options:t}){const r=this.getOptions(e);return this.execute(Object.assign({},r,t,{variables:Object.assign({},r.variables,t.variables)}))}invalidate({query:e}){const{cache:t}=this,r=Object(u.a)({operation:e});t.invalidate({keyPrefix:r})}transformOptions(e){const{metricReporter:t,metricReporter:{now:r}}=this,n=Object(d.a)(e,r),i=Object(u.b)(n),s=Object(f.b)(i),o=Object(b.a)(s);return Object(p.a)(o,this.extraHeaders,this.graphQLGateway,t)}syncResolve(e){const{cache:t}=this,r=Object(l.b)(t,e,this.getRenderingState);if(r)return["cache",r];const n=Object(c.a)(e,this.skipResult);return n?["skip",n]:void 0}asyncResolve(e,t){const{inflight:r,fetch:n,metricReporter:i}=this,s=e=>Object(O.a)(i,n,e).then(r=>this.retry(t,e,r,s)),o=Object(h.b)(r,e);return o?["network-dedupe",o]:["network",s(e)]}retry(e,t,r,n){var i,s,o,a,c;if(null!==(i=r.error)&&void 0!==i&&null!==(s=i.extraInfo)&&void 0!==s&&s.aborted)return r;const{context:{attemptsCount:u=2}}=t;if(u>=4)return r;const{metricReporter:l,retryOnNetworkError:d,retryDelay:h}=this,p=null!==(o=null!==(a=null!==(c=Object(y.b)(t,r))&&void 0!==c?c:Object(v.a)(l,r))&&void 0!==a?a:Object(f.a)(l,t,r))&&void 0!==o?o:Object(g.a)(l,d,h,t,r);if(!p)return r;const{operationName:b}=t;return l.increment("frontend.niobe.retry",1,{operation_name:b,attempt_count:String(u)}),Promise.resolve(p).then(t=>{if(!t)return r;const i=this.transformOptions(Object.assign({},e,{context:Object.assign({},e.context,{skipDedupe:!0},t,{attemptsCount:u+1})}));return n(i).then(t=>this.retry(e,i,t,n))})}processResult({transformedOptions:e,result:t,promise:r,source:n}){const{cache:i,inflight:s,metricReporter:o,jitneyLogger:a,graphQLGateway:c}=this,u=requestIdleCallback;[t=>Object(h.c)(s,e,t)].forEach(e=>e(r));const f=[t=>Object(l.c)(i,e,t),()=>Object(h.a)(s,e),t=>{const r=o.now();u(()=>Object(d.c)(o,a,e,t,n,r,c))}];t?f.forEach(e=>e(t)):r.then(e=>f.forEach(t=>t(e)))}execute(e){if(e.queryRef)return e.queryRef;const t=this.transformOptions(e),[r,n]=(()=>{const r=this.syncResolve(t);if(r){const[t,n]=r;return[t,o.a.for({promise:Promise.resolve(n),result:n,clientType:this,options:e,deferred:n.deferred})]}const[n,i]=this.asyncResolve(t,e),s="server-render"===this.getRenderingState()&&"deferrable"in e&&e.deferrable;return[n,o.a.for({promise:i,clientType:this,options:e,deferred:s})]})();return this.processResult({transformedOptions:t,result:n.result||void 0,promise:n.promise,source:r}),n}useClientSideQuery(e,t){const r=Object(i.a)(()=>t,[t]),s=Object(n.useMemo)(()=>this.preloadQuery(Object.assign({query:e},r)),[r,e,this]);return this.usePreloadedQuery(e,s)}useQueryAggregate(e){const t=Object(n.useRef)(),r=Object(n.useRef)(void 0),{isRerenderScheduled:i,rerender:s}=Object(m.a)(),o=e=>{var t;i.current||(t=e,r.current===t.getResult())||(i.current=!0,s())},a=e=>{t.current=e,e.onLoaded(o),e.watchOnce((e,r)=>{e===t.current&&a(r)}),o(e)};if(!t.current){const t=j.a.fromQueryRef(e,this);r.current=t.getResult(),a(t)}const c=Object(n.useRef)(e);if(e!==c.current){c.current=e;const n=t.current.replaceWith(e);r.current=n.getResult(),a(n)}const u=t.current.getResult();return r.current=u,{queryAggregateRef:t,setQueryAggregate:a,result:u}}usePreloadedQuery(e,t,r,i){const{queryAggregateRef:s,setQueryAggregate:o,result:a}=this.useQueryAggregate(t),c=Object(n.useCallback)((function(e){const r=s.current.refetch(null!=e?e:t.options.variables);return o(r),r.onLoaded(()=>r.getResult())}),[s]),u=Object(n.useCallback)((async function({variables:e,updateQuery:t}){const{newQueryAggregate:r,newQueryPage:n}=s.current.addPage(e,t);return o(r),await n.queryRef.promise,n.getResult()}),[s]);return Object(n.useMemo)(()=>Object.assign({},a,{refetch:c,fetchMore:u,client:this}),[u,c,a])}useMutation(e,t){const[r,i]=Object(n.useState)({data:void 0,error:void 0,called:!1,loading:!1});return[async r=>{i(e=>Object.assign({},e,{loading:!0}));try{var n;const s=await this.mutate(Object.assign({mutation:e},t,r)),o=(null==r?void 0:r.update)||(null==t?void 0:t.update);o&&o(this,s),i(Object.assign({},s,{data:null!==(n=s.data)&&void 0!==n?n:void 0,loading:!1,called:!0}));const a=(null==r?void 0:r.onCompleted)||(null==t?void 0:t.onCompleted);return a&&a((null==s?void 0:s.data)||{}),s}catch(e){throw i({data:void 0,loading:!1,called:!0,error:e}),e}},r]}redirect(e){window.location.href=e}}t.default=k},oema:function(e,t){},uyjd:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("q1tI"),i=r("K/Jt");function s(e,t){const r=Object(n.useRef)();return r.current&&Object(i.a)(t,r.current.key)||(r.current={key:t,value:e()}),r.current.value}}}]);
//# sourceMappingURL=https://sourcemaps.d.musta.ch/airbnb/static/packages/niobe-minimalist-client-3b8db9a3.js.map